<!DOCTYPE html>
<html lang="en">
        <head>
                <link href="css/madescrow_style.css" rel="stylesheet" />
                <meta charset="utf-8" />
                <meta http-equiv="X-UA-Compatible" content="IE=edge" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link href="/images/favicon.ico" rel="icon" />
                <link href="/css/bootstrap.min.css" rel="stylesheet" />
                <link href="/css/font-awesome.min.css" rel="stylesheet" />
                <link href="/css/ie10-viewport-bug-workaround.css" rel="stylesheet" />
                <link href="/css/alertify.min.css" rel="stylesheet" />
                <link href="/css/alertify-bootstrap.min.css" rel="stylesheet" />
                <link href="/css/black.css" rel="stylesheet" id="stylesheet" />
                <link href="/css/small.css" rel="stylesheet" media="only screen and (max-device-width: 480px)" />
                <script src="/js/chart.js" type="text/javascript"></script>
                <link rel="stylesheet" href="css/modal.css">
                <script src="/js/jquery-1.11.1.min.js" type="text/javascript"></script>
                <script src="/js/jquery.translate.js" type="text/javascript"></script>
                <script src="/js/bootstrap.min.js" type="text/javascript"></script>
                <script src="/js/alertify.min.js" type="text/javascript"></script>
                <script src="/js/ejs_production.js" type="text/javascript"></script>
                <script src="/js/chrome-u2f-api.js" type="text/javascript"></script>
                <script src="/js/ledger.min.js" type="text/javascript"></script>
                <script src="/js/main.js" type="text/javascript"></script>
                <script src="/js/web3.min.js"></script>
                <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
                <script src="js/madescrow_function.js" type="text/javascript"></script>
                <link rel="stylesheet" type="text/css" href="extjs/css/ext-all.css" />
                <script type="text/javascript" src="extjs/ext-all.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css" />
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/atatanasov/gijgo@1.7.3/dist/combined/js/gijgo.min.js" type="text/javascript"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-75000235-4', 'auto');
      ga('send', 'pageview');
    </script>
    <script>
      ((window.gitter = {}).chat = {}).options = {
        room: 'etherdelta/etherdelta.github.io',
        activationElement: false
      };
    </script>
    <script src="/js/sidecar.v1.js" async defer></script>

        </head>
    <body>
                <div class="top">
                        <nav class="navbar navbar-default">
                                <div class="container-fluid">
                                        <div class="navbar-header">
                                          <a class="navbar-brand" href="/">
                                                <h4>MadEscrow</h4>
                                          </a>
                                        </div>
                                </div>
                        </nav>
                        <div class="row-header trn"><center>EscrowBook</center>
<div style='background-color:black;margin-top:0px;' id="tx-grid"></div>
<table id="txGrid" style="width:100%;" style='background-color:black;margin-top:0px;'>
</div>
<!--div id="popup_fund">
        <div class="popup">
                                        <a class="close" href="javascript:close_fund();">&times;</a>
                                        <div class="content"  style="width:1200px;height:400px">
                                                <br><br>
                                                <table>
                                                        <tr><td><input type="checkbox" name="fund_all" value="fund_all">Fund All Ladder </td></tr>
                                                        <tr><td>#eth: <input style="text-align:right;" type="text" id="fund_num_eth" size="15"/></td></tr>
                                                        <tr><td>#days: <input style="text-align:right;" type="text" id="fund_num_days" size="15"/></td></tr>
                                                        <tr><td>start date: <input style="text-align:right;" type="text" id="fund_start_date" size="15"/></td></tr>
                                                        <tr><td><input type="button" style="background-color:blue;color:white" value="FUND" onclick="fund_visibility('popup_fund');"></input></td></tr>
                                                </table>
                                        </div>
                                </div>
                        </div-->
</div></div>
<script>
        //document.getElementById("popup_fund").style.display="none";
</script>

                <div class="bottom_half_1">
                        <div class="row-header trn"><center>Messages</center>
                                <table id="msgTable"  style="width:100%">
                                        <tr>
                                        </tr>
                                </table>
                        </div>
        </div>
                <div class="bottom_half_2">
                        <div class="row-container">
                                <div class="row-header trn"><center>My Fundings</center>
                                        <div style="margin-top:10px" class="row-box nav-header">
                                                <ul class="nav nav-tabs two columns" role="tablist">
         <li role="presentation"><a href="#myTrades" aria-controls="myTrades" role="tab" data-toggle="tab" class="trn">Transactions</a></li>
                                                        <li role="presentation"><a href="#myOrders" aria-controls="myOrders" role="tab" data-toggle="tab" class="trn">Balance</a></li>
                                                </ul>
                                        </div>
                                        <div class="row-box">
                                                <div class="row-box height2 scroll">
                                                        <div class="tab-content">
                                                                <div role="tabpanel" class="tab-pane" id="myTrades"></div>
                                                                <div role="tabpanel" class="tab-pane" id="myOrders"></div>
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </div>
<!--div id="popup_fund" style="margin-top:-50px;margin-left:0%;width:1200px;height:400px">
  <div class="popup">
                                        <a class="close" href="javascript:close_fund();">&times;</a>
                                        <div class="content" style="width:1200px;height:400px">
<br><br>
<div class="canvas_top0"  style="clear:both;position:fixed;width:10px;height:400px;margin-left:0%;margin-top:100px">

</div>
<div class="canvas_top1"  style="clear:both;position:fixed;width:1110px;height:400px;margin-left:0%">
<table  width="1100px" height="350px" style="clear:both;position:fixed;left:-5%">
     <tr><td><input type="checkbox" name="fund_all" value="fund_all">Fund All Ladder </td></tr>
                                                        <tr><td align="right">#eth:<input type="text" id="fund_num_eth" size="15"/></td></tr>
                                                        <tr><td align="right">#days:<input type="text" id="fund_num_days" size="15"/></td></tr>
                                                        <tr><td align="right">start date:<input type="text" id="fund_start_date" size="15"/></td></tr>
                                                        <tr><td><input type="button" style="background-color:blue;color:white" value="FUND" onclick="fund_visibility('popup_fund');"></input></td></tr>
                                                </table>
</div>
<div class="canvas_bottom0"   style="clear:both;position:fixed;width:1200px;height:50px;margin-top:300px;margin-left:10%">
</div>
</div></div>
        </div-->
<div id="popup_fund" style="position:fixed;margin-top:0px;left:70%;width:200px;height:200px">

  <div class="popup">
                                        <a class="close" href="javascript:close_fund();">&times;</a>
                                        <div class="content" style="width:200px;height:200px">
<br><br>
<div class="canvas_top0"  style="position:fixed;width:10px;height:200px;margin-left:0%;margin-top:100px">
</div>
<div class="canvas_top1"  style="position:fixed;width:200px;height:200px;margin-left:38%">
<table  width="180px" height="150px" style="position:fixed;left:34%">
                                                        <tr><td><input type="checkbox" name="fund_all" value="fund_all">Fund All Ladder </td></tr>
                                                        <tr><td align="right">#eth:<input type="text" value="" id="fund_num_eth" size="15"/></td></tr>
                                                        <tr><td align="right">start date:<input type="text" value="" id="fund_escrow" size="15"/></td></tr>
             <tr><td><input onclick="fund_visibility('popup_fund');" id="fundTX" type="button" style="background-color:blue;color:white" value="FUND"></td></tr>
                                                </table>
</div>
<!--script>
function waitForReceipt(hash, cb) {
    web3.eth.getTransactionReceipt(hash, function (err, receipt) {
     if (err) {
      }

      if (receipt !== null) {
        // Transaction went through
        if (cb) {
          cb(receipt);
        }
      } else {
        // Try again in 1 second
        window.setTimeout(function () {
          waitForReceipt(hash, cb);
        }, 1000);
      }
    });
  }

var address = "0x7eb4566A7c6989873425eCc039C00D56736f999d";
var abi = [{"constant":false,"inputs":[],"name":"Counter","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"increment","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}];

$(function () {
    var counter;

    $('#fundTX').click(function (e) {
      e.preventDefault();

      if(web3.eth.defaultAccount === undefined) {
      }

      counter.increment.sendTransaction(function (err, hash) {
        if (err) {
          return error(err);
        }
     waitForReceipt(hash, function () {
          log("Transaction succeeded. " +
              "Call getCount again to see the latest count.");
        });
      });
    });

    if (typeof(web3) === "undefined") {
    } else {
      web3 = new Web3(web3.currentProvider);
        counter = web3.eth.contract(abi).at(address);
        $('#fundTX').click();
    }
  });


</script-->
<script>

$(function () {
        var counter;

var i = 0,index = 1;
$('#fundTX').click(function (e) {
        /*e.preventDefault();
        var cell_tx_id = crow.getElementsByTagName("td")[0].innerHTML;
        var num_eth = document.getElementById("fund_num_eth").innerHTML;
        console.log(cell_tx_id);

        madeContract.addLadderTx(cell_tx_id,made_escrow,made_fee,function(error, result){

                if(!error)
     console.log(result);
                else
                        console.error(error);
                });*/
});

$( document ).ready(function() {
                var merchant_address = "0xfec455fd841ce1eb410dee0096ee7a02db7e0b1b";
                var txCount = -1;
startTXGrid();
    setInterval(function(){ madeContract.getVendorTransactionsCount(merchant_address,function(error, result){

     if(!error){
        txCount = result.c[0];

     }
     else {
         txCount = -1;
     }

     while(i < txCount){
     madeContract.getMadeWidgetTx(merchant_address,i,function(error, result){
     if(!error){
//        console.log(result[0],result[1],result[2].c[0],result[3].c[0],result[4].c[0]);
        txGrid.addRow({"customer":result[0],"vendor":result[1],"expire":result[3].c[0],"fee":result[4].c[0],
"txval":result[2].c[0],"txid":index,"feeapr":1,"customerfund":1,"vendorfund":1,"tfunded":1,"tfunders":1,"short":1});
txGrid.reload();
index++;
        }
     else
         console.error(error);
     });
        i++;
txGrid.reload();
      //addClickHandlers();
        }
        //addClickHandlers();

//txGrid.reload();

        i=txCount});},3000);

    });

  });
</script>


<div class="canvas_bottom0"   style="margin-top:300px;">
</div>
</div></div>
        </div>
<div id="ladderGrid" style="position:fixed;margin-top:0px;margin-left:20%;width:450px;height:400px">
  <div class="popup">
                                        <a class="close" href="javascript:close_ladder();">&times;</a>
                                        <div class="content" style="width:400px;height:400px">
<div id= "txid" align="center"></div>
<div class="canvas_top0"  style="position:fixed;width:10px;height:400px;margin-left:0%;margin-top:100px">
Eth
</div>
<div class="canvas_top1"  style="position:fixed;width:390px;height:400px;margin-left:2%">
<canvas id="ladder"  style="position:fixed;"  width="380px" height="350px"></canvas>
</div>
    <div class="canvas_bottom0"   style="position:fixed;width:400px;height:50px;margin-top:298px;margin-left:10%">
Days
 <a class="btn mr-2 mb-2 page-scroll"  style="position:fixed;color:white;background-color: blue;margin-top:60px;margin-left:-2%" onclick="fund_visibility_click('popup_fund');">FUND</a>
</div>
</div></div>
        </div>

        <div id="ladderGrid1" style="position:fixed;margin-top:0px;margin-left:20%;width:450px;height:400px">
  <div class="popup">
                                        <a class="close" href="javascript:close_ladder1();">&times;</a>
                                        <div class="content" style="width:400px;height:400px">
<h5>Escrow ladder for Transaction id: tx1</h5>
<div class="canvas_top0"  style="position:fixed;width:10px;height:400px;margin-left:0%;margin-top:100px">
Eth
</div>
<div class="canvas_top1"  style="position:fixed;width:390px;height:400px;margin-left:2%">
<canvas id="ladder1" style="position:fixed;" width="380px" height="350px"></canvas>
</div>
<div class="canvas_bottom0"   style="position:fixed;width:400px;height:50px;margin-top:298px;margin-left:10%">
Days
 <a class="btn mr-2 mb-2 page-scroll"  style="position:fixed;color:white ;background-color: blue;margin-top:60px;margin-left:-2%" onclick="fund_visibility_click('popup_fund');">FUND</a>
</div>
</div></div>
        </div>
    <div id="ladderGrid2" style="position:fixed;margin-top:0px;margin-left:20%;width:450px;height:400px">
  <div class="popup">
                                        <a class="close" href="javascript:close_ladder2();">&times;</a>
                                        <div class="content" style="width:400px;height:400px">
<h5>Escrow ladder for Transaction id: tx2</h5>
<div class="canvas_top0"  style="position:fixed;width:10px;height:400px;margin-left:0%;margin-top:100px">
Eth
</div>
<div class="canvas_top1"  style="position:fixed;width:390px;height:400px;margin-left:2%">
<canvas id="ladder2" style="position:fixed;" width="380px" height="350px"></canvas>
</div>
<div class="canvas_bottom0"   style="position:fixed;width:400px;height:50px;margin-top:298px;margin-left:10%">
Days
 <a class="btn mr-2 mb-2 page-scroll"  style="position:fixed;color:white ;background-color: blue;margin-top:60px;margin-left:-2%" onclick="fund_visibility_click("popup_fund");">FUND</a>
</div>
</div></div>
        </div>
<div id="ladderGrid3" style="margin-top:0px;margin-left:20%;width:450px;height:400px">
  <div class="popup">
                                        <a class="close" href="javascript:close_ladder3();">&times;</a>
                                        <div class="content" style="width:400px;height:400px">
<h5>Escrow ladder for Transaction id: tx3</h5>
<div class="canvas_top0"  style="position:fixed;width:10px;height:400px;margin-left:0%;margin-top:100px">
Eth
</div>
<div class="canvas_top1"  style="position:fixed;width:390px;height:400px;margin-left:2%">
<canvas id="ladder3" width="380px" height="350px"></canvas>
</div>
<div class="canvas_bottom0"   style="clear:both;position:fixed;width:400px;height:50px;margin-top:298px;margin-left:10%">
Days
 <a class="btn mr-2 mb-2 page-scroll"  style="position:fixed;color:white ;background-color: blue;margin-top:60px;margin-left:-2%" onclick="fund_visibility_click('popup_fund');">FUND</a>
</div>
    </div></div>
        </div>

<script>
        document.getElementById("ladderGrid").style.display="none";
        document.getElementById("ladderGrid1").style.display="none";
        document.getElementById("ladderGrid2").style.display="none";
        document.getElementById("ladderGrid3").style.display="none";

</script>
<script>
//https://stackoverflow.com/questions/13990128/how-to-fill-a-cell-on-clicking-the-grid-on-canvas-in-html5

function drawBox() {
  c.beginPath();
  c.fillStyle = "white";
  c.lineWidth = 3;
  for (var row = 0; row < boxes; row++) {
    for (var column = 0; column < boxes; column++) {
      var x = column * boxSize;
      var y = row * boxSize;
   c.rect(x, y, boxSize, boxSize);
      c.fill();
      c.stroke();
    }
  }
  c.closePath();
}

function handleClick(e) {

    }

//drawBox();
</script>

<script>
document.getElementById("popup_fund").style.display="none";
//window.onload = addClickHandlers();
//startTXGrid();
</script>


        <!--script src="js/draggabilly.pkgd.js"></script>
        <script src="js/modal.js"></script>
        <script>
                window.onload = function(e){

                        Modal.init();

                };
        </script-->
</body>
</html>